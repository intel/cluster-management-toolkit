kind: Pod
default_command: pods
command:
- po
listview:
  name: Pods
  group: Workloads
  field_indexes:
    Wide: [namespace, name, controller, pod_status, node_name, pod_ip, age, restarts, last_restart, containers]
    Normal: [namespace, name, controller, pod_status, node_name, age, restarts, last_restart]
    Compact: [name, pod_status, node_name, age, restarts, last_restart]
  fields:
    controller:
      header: "Controller:"
      paths:
      - path: "metadata#ownerReferences"
        pathtype: items
        subpaths:
        - kind
        - apiVersion
        - name
        when:
          key: controller
          eq: true
        type: [kind, api_version, name]
      formatting:
        field_colors:
        - type: kind
        - type: kind
        - type: generic
        field_separators:
        - type: kind_apigroup
        - type: kind
      formatter: list
    node_name:
      header: "Node:"
      path: "spec#nodeName"
      type: host
      default: "<none>"
    pod_ip:
      header: "Pod IP:"
      path: "status#podIP"
      default: "<unset>"
      type: ipaddress
    restarts:
      header: "Restarts:"
      paths:
      - path: "status#containerStatuses"
        pathtype: items
        subpath: "restartCount"
        action: sum
        type: int
      align: right
      default: 0
    last_restart:
      header: "Latest Restart:"
      paths:
      - path: "status#containerStatuses"
        pathtype: items
        subpath: ["state#running#startedAt", "lastState#terminated#finishedAt"]
        when:
          key: "restartCount"
          gt: 0
        action: latest
        type: timestamp
      default: -1
      formatter: age
      align: right
    containers:
      header: "Containers:"
      paths:
      - paths:
        - "spec#initContainers"
        - "spec#containers"
        pathtype: items
        subpaths:
        - name
        - subpath: image
          regex: ["^.+/[^:^/]+:(.+?)@.*", "^.+/[^:^/]+:(.+)"]
        type: raw
      formatter: list
      formatting:
        field_colors:
        - type: generic
        - type: version
        field_separators:
        - type: version
  sortcolumn: pod_status
  listview_args:
    filters:
      evicted:
        source: object
        enabled: true
        block:
        - key: "status#phase"
          values: [Failed]
        - key: "status#reason"
          values: [Evicted]
  actions:
    actionlist:
      "Delete resource":
        description: Delete resource
        confirm: true
        actionfunc: delete_resource
      "Force delete resource":
        description: Delete resource (No grace period)
        confirm: true
        actionfunc: force_delete_resource
  shortcuts:
    "Show Evicted Pods":
      key: e
      modifier: shift
      helptext: "Show / Hide evicted pods"
      action: toggle_var
      action_args:
        var: "filters#evicted#enabled"
  statusmsg:
  - ["Hide evicted pods: ", "filters#evicted#enabled"]
