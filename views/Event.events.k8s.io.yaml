kind: Event
# For now this doesn't work; to be fixed
# api_family: events.k8s.io
default_command: events
command:
- ev
listview:
  name: Events
  group: Core
  field_indexes:
    Wide: [namespace, name, seen, type, event_reason, regarding, reporter, first_seen, count, message]
    Normal: [namespace, name, seen, type, event_reason, regarding, message]
  fields:
    seen:
      header: "Last Seen:"
      paths:
      - path: ["series#lastObservedTime", "deprecatedLastTimestamp", "lastTimestamp", "eventTime", "deprecatedFirstTimestamp", "firstTimestamp"]
        pathtype: value
        type: timestamp
      formatter: age
      align: right
    type:
      header: "Type:"
      path: "type"
      type: str
      formatter: value_mapper
      formatting:
        mapping:
          mappings:
            Error:
              field_colors:
              - context: main
                type: status_not_ok
            Warning:
              field_colors:
              - context: main
                type: status_admin
            Normal:
              field_colors:
              - context: main
                type: status_ok
    regarding:
      header: "Regarding:"
      paths:
      - path: [["regarding#kind", "involvedObject#kind"], ["regarding#apiVersion", "involvedObject#apiVersion"], ["regarding#name", "involvedObject#name"]]
        pathtype: tuple
        type: [kind, api_version, name]
      formatting:
        field_colors:
        - type: kind
        - type: kind
        - type: generic
        field_separators:
        - type: kind_apigroup
        - type: kind
      formatter: list
    reporter:
      header: "Reporter:"
      paths:
      - path: [["reportingController", "deprecatedSource#component", "source#component"], ["reportingInstance", "deprecatedSource#host", "source#host"]]
        default: ["", ""]
        # This is needed, because the old Events API can return the new fields empty
        fallback_on_empty: true
        pathtype: tuple
        type: raw
      formatting:
        field_colors:
        - type: generic
        - type: generic
      formatter: list
    first_seen:
      header: "First Seen:"
      paths:
      - path: ["eventTime", "deprecatedFirstTimestamp", "firstTimestamp"]
        pathtype: value
        type: timestamp
      formatter: age
      align: right
    count:
      header: "Count:"
      paths:
      - path: ["series#count", "deprecatedCount", "count"]
        pathtype: value
        type: raw
      default: -1
      formatter: numerical
      align: right
    message:
      header: "Message:"
      paths:
      - path: "message"
        pathtype: value
        type: str
        replace_quotes: same
  sortcolumn: seen
  shortcuts:
    "Show Resource":
      key: r
      modifier: shift
      helptext: "Open info page for the resource that triggered the event"
      action: call
      action_call: eventdispatch
      action_args:
        _pass_obj: true
        kind_path: ["regarding#kind", "involvedObject#kind"]
        name_path: ["regarding#kind", "involvedObject#name"]
        namespace_path: ["regarding#kind", "involvedObject#namespace"]
        api_version_path: ["regarding#apiVersion", "involvedObject#apiVersion"]
